---
title: useRefの使いどき
date: '2020-12-29T02:00:00'
category: Knowledge
tags: ['react', 'react-hooks', 'use-ref']
status: 'published'
---

下記の 2 パターンで利用する；

1. DOM ノードの参照を持つときに使う
2. re-render を走らせたくない変数に使う

# DOM ノードの参照を持つときに使う

```tsx
function TextInputWithFocusButton() {
  const inputEl = useRef(null);
  const onButtonClick = () => {
    // `current` points to the mounted text input element
    inputEl.current.focus();
  };
  return (
    <>
      <input ref={inputEl} type="text" />
      <button onClick={onButtonClick}>Focus the input</button>
    </>
  );
}
```

https://ja.reactjs.org/docs/hooks-reference.html#useref

`const inputEl = useRef(null);` で参照を作り、DOM に対して `ref={inputEl}` と指定すると、inputEl.current に DOM 参照が格納される。

# re-render を走らせたくない変数に使う

```tsx
function Timer() {
  const intervalRef = useRef();

  useEffect(() => {
    const id = setInterval(() => {
      // ...
    });
    intervalRef.current = id;
    return () => {
      clearInterval(intervalRef.current);
    };
  });

  // ...
}
```

https://ja.reactjs.org/docs/hooks-faq.html#is-there-something-like-instance-variables

**関数コンポーネントにおける、クラスのインスタンス変数として使える。**このとき useRef はオブジェクトを作ってその参照を返すので、`intervalRef.current` の値を変更しても、intervalRef 自体が変更されないことから、**re-render が走らない。**

他方 Hooks は関数コンポーネントのインスタンスごとに ref を接続するため、コンポーネント単位でインスタンス変数を持っていることと等価になる。

# references

- https://ja.reactjs.org/docs/hooks-reference.html#useref
- https://ja.reactjs.org/docs/hooks-faq.html#is-there-something-like-instance-variables
- https://yukinaka.me/react-useref
